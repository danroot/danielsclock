<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central Time Clock</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 800px;
            height: 480px;
            overflow: hidden;
            position: relative;
            font-family: 'Trebuchet MS', serif;
            transition: background-color 0.3s, color 0.3s;
            border:1px solid #ccc;
        }
        
        /* Light mode (7pm to 6am): black on white */
        body.light-mode {
            background-color: white;
            color: black;
        }
        body.light-mode .clock-face {
            fill: white;
            stroke: #333;
        }
        body.light-mode .clock-element {
            stroke: #333;
            fill: #333;
        }
        body.light-mode .hour-marker {
            stroke: #ccc;
        }
        
        /* Dark mode (6am to 7pm): white on black */
        body.dark-mode {
            background-color: black;
            color: white;
        }
        body.dark-mode .clock-face {
            fill: black;
            stroke: white;
        }
        body.dark-mode .clock-element {
            stroke: white;
            fill: white;
        }
        body.dark-mode .hour-marker {
            stroke: #666;
        }
        
        .container {
            position: absolute;
            left: 10px;
            top: 65px;
            bottom: 0;
            display: flex;
            align-items: center;
        }
        .container svg {
            width: 380px !important;
            height: 380px !important;
        }
        .date {
            position: absolute;
            top: 5px;
            left: 20px;
            font-size: 36px;
            font-weight: bold;
        }
        .feast-day{
            position: absolute;
            top: 50px;
            left: 20px;
            font-size: 16px;
        }
        .fasting-info {
            display: block;
            font-size: 14px;
            margin-top: 2px;
            position: absolute;
            top: 72px;
            left: 20px;
        }
        .weather {
            position: absolute;
            top: 5px;
            right: 20px;
            font-size: 36px;          
            text-align: right;
        }
        .weather-icon {
            width: 40px;
            height: 50px;
            display: inline-block;
            vertical-align: middle;
            margin-right: -8px;
            margin-top: -3px;
            margin-bottom: 5px;
        }
        .weather-temp {
            display: block;
        }
        .light{
            color: #ccc;
        }
        .weather-high-low {
            display: block;
            font-size: 16px;
            font-weight: normal;
            margin-top: -5px;
        }
        .forecast {
            position: absolute;
            top: 54px;
            right: 20px;
            width: 140px;
            font-size: 16px;
        }
        .forecast-day {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            justify-content: space-between;
        }      
        .forecast-temps {
            flex: 1;
            font-size: 15px;
            text-align: right;
            margin-left: 3px;
        }
        .forecast-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }
        
        /* Icon preview mode */
        .icon-preview {
            display: none;
            padding: 20px;
            width: 100%;
            height: 100%;
            box-sizing: border-box;
        }
        .icon-preview.active {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            align-content: start;
        }
        .icon-preview-item {
            text-align: center;
            padding: 15px;
            border: 2px solid currentColor;
            border-radius: 8px;
        }
        .icon-preview-item svg {
            width: 64px;
            height: 64px;
            margin-bottom: 10px;
        }
        .icon-preview-item .label {
            font-size: 18px;
            font-weight: bold;
        }
        body.preview-mode .container,
        body.preview-mode .date,
        body.preview-mode .weather {
            display: none;
        }
    </style>
</head>
<body>
    <!-- SVG Weather Icons -->
    <svg style="display: none;">
        <defs>
            <!-- Clear sky / Sunny -->
            <symbol id="icon-clear" viewBox="0 0 48 48">
                <circle cx="24" cy="24" r="8" fill="currentColor"/>
                <line x1="24" y1="4" x2="24" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="24" y1="36" x2="24" y2="44" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="4" y1="24" x2="12" y2="24" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="36" y1="24" x2="44" y2="24" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="9.9" y1="9.9" x2="15.8" y2="15.8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="32.2" y1="32.2" x2="38.1" y2="38.1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="9.9" y1="38.1" x2="15.8" y2="32.2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="32.2" y1="15.8" x2="38.1" y2="9.9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <!-- Partly cloudy -->
            <symbol id="icon-partly-cloudy" viewBox="0 0 48 48">
                <circle cx="18" cy="16" r="5" fill="currentColor"/>
                <line x1="18" y1="6" x2="18" y2="9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="8" y1="16" x2="11" y2="16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="11" y1="10" x2="13" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                <line x1="25" y1="10" x2="23" y2="12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                <path d="M 14 24 Q 14 20 18 20 Q 20 20 21 22 Q 23 20 26 20 Q 30 20 30 24 Q 30 24 34 24 Q 38 24 38 28 Q 38 32 34 32 L 14 32 Q 10 32 10 28 Q 10 24 14 24 Z" fill="none" stroke="currentColor" stroke-width="2"/>
            </symbol>
            
            <!-- Cloudy / Overcast -->
            <symbol id="icon-cloudy" viewBox="0 0 48 48">
                <path d="M 10 20 Q 10 16 14 16 Q 16 16 17 18 Q 19 16 22 16 Q 26 16 26 20 Q 26 20 30 20 Q 34 20 34 24 Q 34 28 30 28 L 10 28 Q 6 28 6 24 Q 6 20 10 20 Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M 14 28 Q 14 28 14 30 Q 14 34 18 34 L 38 34 Q 42 34 42 30 Q 42 26 38 26 Q 38 26 38 24" fill="none" stroke="currentColor" stroke-width="2"/>
            </symbol>
            
            <!-- Fog -->
            <symbol id="icon-fog" viewBox="0 0 48 48">
                <line x1="8" y1="16" x2="40" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="12" y1="24" x2="36" y2="24" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="8" y1="32" x2="40" y2="32" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <!-- Rain -->
            <symbol id="icon-rain" viewBox="0 0 48 48">
                <path d="M 14 16 Q 14 12 18 12 Q 20 12 21 14 Q 23 12 26 12 Q 30 12 30 16 Q 30 16 34 16 Q 38 16 38 20 Q 38 24 34 24 L 14 24 Q 10 24 10 20 Q 10 16 14 16 Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <line x1="16" y1="28" x2="16" y2="36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="24" y1="28" x2="24" y2="36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <line x1="32" y1="28" x2="32" y2="36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </symbol>
            
            <!-- Snow -->
            <symbol id="icon-snow" viewBox="0 0 48 48">
                <path d="M 14 16 Q 14 12 18 12 Q 20 12 21 14 Q 23 12 26 12 Q 30 12 30 16 Q 30 16 34 16 Q 38 16 38 20 Q 38 24 34 24 L 14 24 Q 10 24 10 20 Q 10 16 14 16 Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <g>
                    <line x1="16" y1="32" x2="16" y2="32" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    <line x1="24" y1="28" x2="24" y2="28" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    <line x1="32" y1="34" x2="32" y2="34" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    <line x1="20" y1="36" x2="20" y2="36" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    <line x1="28" y1="32" x2="28" y2="32" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                </g>
            </symbol>
            
            <!-- Thunderstorm -->
            <symbol id="icon-thunderstorm" viewBox="0 0 48 48">
                <path d="M 14 16 Q 14 12 18 12 Q 20 12 21 14 Q 23 12 26 12 Q 30 12 30 16 Q 30 16 34 16 Q 38 16 38 20 Q 38 24 34 24 L 14 24 Q 10 24 10 20 Q 10 16 14 16 Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M 26 26 L 22 32 L 26 32 L 22 40" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </symbol>
        </defs>
    </svg>
    <div class="date" id="date"></div>
    <section class="weather" id="weather" aria-label="Current weather in Madison, Mississippi">
        <div class="weather-temp" id="weather-temp" aria-live="polite">{{WEATHER_TEMP}}</div>
    </section>
    <div class="forecast" id="forecast" aria-label="7-day weather forecast">
        {{FORECAST}}
    </div>
    <div class="feast-day" id="feast-day" aria-live="polite">{{FEAST_DAY_TITLE}}</div>
    <div class="fasting-info" id="fasting-info">{{FASTING_INFO}}</div>
    
    <div class="icon-preview" id="icon-preview">
        <div class="icon-preview-item">
            <svg><use href="#icon-clear"></use></svg>
            <div class="label">Clear Sky</div>
        </div>
        <div class="icon-preview-item">
            <svg><use href="#icon-partly-cloudy"></use></svg>
            <div class="label">Partly Cloudy</div>
        </div>
        <div class="icon-preview-item">
            <svg><use href="#icon-cloudy"></use></svg>
            <div class="label">Cloudy</div>
        </div>
        <div class="icon-preview-item">
            <svg><use href="#icon-fog"></use></svg>
            <div class="label">Fog</div>
        </div>
        <div class="icon-preview-item">
            <svg><use href="#icon-rain"></use></svg>
            <div class="label">Rain</div>
        </div>
        <div class="icon-preview-item">
            <svg><use href="#icon-snow"></use></svg>
            <div class="label">Snow</div>
        </div>
        <div class="icon-preview-item">
            <svg><use href="#icon-thunderstorm"></use></svg>
            <div class="label">Thunderstorm</div>
        </div>
    </div>
    <div class="container">
        <svg width="380" height="380">
            <!-- Clock face -->
            <circle cx="190" cy="190" r="177" class="clock-face" stroke-width="2"/>
            <circle cx="190" cy="190" r="170" class="clock-face" stroke-width="2"/>
            
            <!-- Hour hand -->
            <g id="hour-hand" class="clock-element">
                <line x1="190" y1="190" x2="190" y2="124" stroke-width="8"/>
                <polygon points="190,114 185,124 195,124" fill="currentColor"/>
            </g>
            
            <!-- Minute hand -->
            <g id="minute-hand" class="clock-element">
                <line x1="190" y1="190" x2="190" y2="86" stroke-width="5"/>
                <polygon points="190,76 186,86 194,86" fill="currentColor"/>
            </g>
            
            <!-- Hour numbers -->
            <text x="190" y="43" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">12</text>
            <text x="264" y="67" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">1</text>
            <text x="322" y="117" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">2</text>
            <text x="345" y="190" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">3</text>
            <text x="322" y="263" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">4</text>
            <text x="264" y="313" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">5</text>
            <text x="190" y="337" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">6</text>
            <text x="116" y="313" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">7</text>
            <text x="58" y="263" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">8</text>
            <text x="35" y="190" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">9</text>
            <text x="64" y="117" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">10</text>
            <text x="116" y="67" text-anchor="middle" dominant-baseline="middle" font-size="30" font-weight="bold" class="clock-element">11</text>
            
            <!-- Center dot -->
            <circle cx="190" cy="190" r="10" class="clock-element"/>
            <circle cx="190" cy="190" r="5" fill="white" stroke="white"/>
        </svg>
    </div>

    <script>
        // Madison, MS coordinates
        const MADISON_LAT = 32.4610;
        const MADISON_LON = -90.1153;
        
        // Check for dark mode query parameter or time of day
        function setTheme() {
            const urlParams = new URLSearchParams(window.location.search);
            const forceDarkMode = urlParams.has('darkmode');
            const isPreviewMode = urlParams.has('previewicons');
            
            // Build class list
            let classes = [];
            if (forceDarkMode) {
                classes.push('dark-mode');
            } else {
                classes.push('light-mode');
            }
            if (isPreviewMode) {
                classes.push('preview-mode');
            }
            
            document.body.className = classes.join(' ');
        }
        
        function updateClock() {
            const now = new Date();
            
            // Get time in Central Time using proper formatter
            const formatter = new Intl.DateTimeFormat('en-US', {
                timeZone: 'America/Chicago',
                hour: 'numeric',
                minute: 'numeric',
                hour12: false
            });
            
            const parts = formatter.formatToParts(now);
            const hourValue = parts.find(p => p.type === 'hour').value;
            const minuteValue = parts.find(p => p.type === 'minute').value;
            
            const hours = parseInt(hourValue) % 12;
            const minutes = parseInt(minuteValue);
            
            // Calculate angles (no offset needed - hands start at 12 o'clock)
            const minuteAngle = minutes * 6; // 6 degrees per minute
            const hourAngle = hours * 30 + minutes * 0.5; // 30 degrees per hour
            
            // Update hands
            document.getElementById('minute-hand').setAttribute('transform', `rotate(${minuteAngle} 190 190)`);
            document.getElementById('hour-hand').setAttribute('transform', `rotate(${hourAngle} 190 190)`);
            
            // Update date
            const dateFormatter = new Intl.DateTimeFormat('en-US', {
                timeZone: 'America/Chicago',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('date').textContent = dateFormatter.format(now);
        }
        
        // Set initial theme (includes preview-mode if needed)
        setTheme();
        
        // Show icon preview if requested
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('previewicons')) {
            document.getElementById('icon-preview').classList.add('active');
        }
        
        // Update theme every minute in case the time crosses a threshold
        setInterval(setTheme, 60000);
        
        updateClock();
        setInterval(updateClock, 1000);
    </script>
</body>
</html>
